# TwitchPicker

Браузерное расширение для автоматического фарма канальных поинтов и дропов на Twitch. Отслеживает каналы, уведомляет о начале и окончании стримов, может просматривать трансляции в фоне и собирать награды без постоянного открытия вкладок.

**Язык интерфейса:** только русский.  
**Платформа:** Chromium-браузеры (Chrome, Opera, Yandex, Edge и др.).

---

## Функционал

### Отслеживание каналов
- Добавление каналов по логину (латиница, без пробелов).
- Проверка статуса «в эфире» примерно раз в минуту через внешний API.
- Список каналов в боковой панели: онлайн/офлайн, ссылка на канал, кнопки управления.

### Фоновый просмотр
- Когда отслеживаемый канал выходит в эфир, расширение открывает его трансляцию в скрытом iframe.
- Время просмотра засчитывается без необходимости держать вкладку Twitch открытой.

### Канальные поинты
- На странице стрима автоматически нажимается кнопка бонуса (claimable bonus) каждые ~5 секунд.
- Баланс поинтов отображается в истории действий в боковой панели.

### Дропы
- При включённой опции «Авто-сбор дропов» расширение загружает страницу [Twitch Drops / Inventory](https://www.twitch.tv/drops/inventory) в фоне.
- Кнопки «Забрать» на дропах нажимаются автоматически; о полученных дропах пишется в историю.

### Уведомления
- Оповещения при выходе канала в эфир и при окончании трансляции.
- В настройках можно включить/выключить уведомления и настроить громкость звука (если добавлены аудиофайлы).

### Авто-чат (опционально)
- Для каждого канала можно включить отправку случайных фраз из словаря в чат с заданным интервалом (по умолчанию примерно 500–950 секунд).
- Интервал настраивается в настройках (мин/макс в секундах).
- Используется только если вы авторизованы на Twitch в этом же браузере.

### История действий
- В боковой панели ведётся лог: добавление/удаление каналов, собранные дропы, поинты, сообщения в чат и другие события.

---

## Важно

**Мы не несём ответственности за сохранность ваших аккаунтов Twitch.**  
Использование авто-чата и фонового просмотра может противоречить правилам Twitch. Пользуйтесь на свой риск.

Для работы фонового просмотра и авто-чата нужна авторизация на Twitch в том же браузере, где установлено расширение.

---

## Установка

1. **Скачайте расширение**  
   Скачайте архив или клонируйте репозиторий и распакуйте в любую папку на компьютере.

2. **Откройте страницу расширений**  
   В адресной строке введите:
   - Chrome / Yandex / Edge: `chrome://extensions/`
   - Opera: `opera://extensions/`  
   (или через меню браузера: «Расширения» → «Управление расширениями».)

3. **Включите режим разработчика**  
   Переключатель «Режим разработчика» (Developer mode) в правом верхнем углу страницы должен быть включён.

4. **Загрузите расширение**  
   Нажмите **«Загрузить распакованное расширение»** (Load unpacked) и выберите папку, в которой лежат файлы расширения (там должны быть `manifest.json`, папки `html`, `scripts`, `css`, `img` и т.д.).

5. **Готово**  
   Иконка TwitchPicker появится на панели расширений. При первом использовании может потребоваться разрешить доступ к уведомлениям.

### Звуки уведомлений (необязательно)

Чтобы при уведомлениях проигрывался звук, создайте в корне папки расширения папку `audio` и поместите в неё файлы:
- `notif.mp3` — основной звук уведомления;
- `extra.mp3` — дополнительный (если используется в коде).

Без этих файлов уведомления будут только визуальными.

---

## Использование

### Открытие панели
- Нажмите на иконку расширения TwitchPicker в панели браузера.  
- Откроется **боковая панель** с интерфейсом (список каналов, форма добавления, история, настройки).

### Добавление канала
1. В блоке **«Добавить новый канал»** введите логин канала (только латиница, без пробелов).
2. Нажмите кнопку отправки (или Enter).
3. Канал появится в **«Список отслеживаемых»**. Когда он будет в эфире, расширение может начать фоновый просмотр и уведомить вас.

### Управление каналами
- **Зелёная/серая точка** — канал в эфире или офлайн.
- **Ссылка на канал** — переход на страницу стрима.
- **Иконка чата** — включить/выключить авто-отправку фраз в чат этого канала.
- **Кнопка удаления** — убрать канал из списка; фоновый просмотр и авто-чат для него прекратятся.

### Настройки
Нажмите на **иконку шестерёнки** в шапке панели. Откроется окно настроек:

| Параметр | Описание |
|----------|----------|
| **Уведомления включены** | Вкл/выкл уведомления о выходе в эфир и окончании стрима. |
| **Громкость уведомлений** | Громкость звука уведомлений (0–100%). |
| **Авто-сбор дропов** | Вкл/выкл автоматический сбор дропов со страницы Inventory. |
| **Частота авто-чата (сек)** | Минимальный и максимальный интервал в секундах между отправками случайной фразы в чат (например, 500 и 950). |

Изменения сохраняются автоматически.

### История действий
Внизу панели отображается **«История действий»**: события по каналам, дропы, поинты, сообщения в чат и т.д. Прокручивайте список, чтобы посмотреть последние записи.

---

## Структура проекта (для разработчиков)

- `manifest.json` — манифест расширения (Manifest V3).
- `html/options.html` — основная страница боковой панели.
- `scripts/background.js` — сервис-воркер: опрос каналов, уведомления, управление offscreen-документом.
- `scripts/options.js` — логика панели: список каналов, настройки, история.
- `scripts/watcher.js` — контент-скрипт на страницах Twitch: поинты, авто-чат.
- `scripts/drops.js` — контент-скрипт на странице дропов: авто-нажатие «Забрать».
- `scripts/offscreen.js` — скрытая страница: iframe со стримами и дропами, воспроизведение звуков.
- `rules/frame_headers.json` — правила Declarative Net Request для встраивания Twitch в iframe.
- `dictionary.json` — массив строк для случайных сообщений в чат.
- `css/`, `img/` — стили и иконки.

Сборка не требуется: расширение подключается как «распакованное».

---

## Версия

Текущая версия расширения указана в `manifest.json` (поле `version`).
